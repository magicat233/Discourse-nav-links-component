<script type="text/discourse-plugin" version="0.8.18">

var nmlt = settings.Nav_links,
  sec = $.map(nmlt.split("|"), $.trim);
  

$.each(sec, function(value) {
  var sec = $.map(this.split(";"), $.trim),
    filter = sec[0].replace(/\s+/g, "-").toLowerCase();
//  api.onPageChange((url) =>{
//    var root = url.split('/')[1];
//    getLocation(root);
//    console.log(url);
//    console.log(getLocation(root));
//  });
//  function getLocation(root){
//      if(root == "c"){
//        var location = window.location.pathname + '/l/latest' + sec[2];
//      }else{
//        var location = window.location.pathname + '/latest' + sec[2];
//      }
//      return location;
//  }
  $( document ).ajaxComplete(function() {
    var root = window.location.pathname.split('/')[1];
    if(root == "c"){
      var location = window.location.pathname + '/l/latest' + sec[2];
    }else{
      var location = window.location.pathname + '/latest' + sec[2];
    }
    
  }); 
  api.addNavigationBarItem({
    name: filter,
    displayName: sec[0],
    title: sec[1],
    href: location
  });


  api.modifyClass("component:navigation-item", {
    active: Ember.computed("contentFilterMode", "filterMode", function() {
      let contentFilterMode = this.get("content").get("filterMode");

      if (window.location.pathname === location) {
        return contentFilterMode === filter;
      } else {
        return this._super(contentFilterMode, this.get("filterMode"));
      }
    })
  });
});

</script>
